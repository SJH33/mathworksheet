<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Math Worksheet Generator</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/fraction.js/4.1.1/fraction.min.js"></script>
  <style>
    body {
      font-family: Arial, sans-serif;
      padding: 40px;
      text-align: center;
    }
    h1 {
      font-weight: bold;
    }
  </style>
</head>
<body>
  <h1>Math with Ms. Jean</h1>
  <p>Generate a one-page worksheet covering Integers, Fractions, and Decimals.</p>
  <button class="btn btn-primary" onclick="generatePDF()">Generate Worksheet</button>

  <script>
    function getRandomInt(min, max) {
      return Math.floor(Math.random() * (max - min + 1)) + min;
    }

    function simplifyFraction(numerator, denominator) {
      const frac = new Fraction(numerator, denominator);
      return frac.toFraction(true).replace("/", "⁄");
    }

    function generateProblems() {
      const intProblems = [];
      for (let i = 0; i < 4; i++) {
        const a = getRandomInt(10, 99);
        const b = getRandomInt(1, 99);
        const op = ["+", "-", "×", "÷"][getRandomInt(0, 3)];
        intProblems.push(`${a} ${op} ${b} = `);
      }

      const fracProblems = [];
      for (let i = 0; i < 4; i++) {
        const n1 = getRandomInt(1, 9), d1 = getRandomInt(2, 9);
        const n2 = getRandomInt(1, 9), d2 = getRandomInt(2, 9);
        const op = ["+", "-", "×", "÷"][getRandomInt(0, 3)];

        const frac1 = `${n1}/${d1}`;
        const frac2 = `${n2}/${d2}`;

        let answer;
        try {
          const f1 = new Fraction(n1, d1);
          const f2 = new Fraction(n2, d2);
          if (op === "+") answer = f1.add(f2);
          if (op === "-") answer = f1.sub(f2);
          if (op === "×") answer = f1.mul(f2);
          if (op === "÷") answer = f1.div(f2);
          answer = answer.toFraction(true).replace("/", "⁄");
        } catch {
          answer = "?";
        }

        fracProblems.push({ question: `${n1}/${d1} ${op} ${n2}/${d2} = `, answer });
      }

      const decProblems = [];
      for (let i = 0; i < 4; i++) {
        const a = (Math.random() * 10).toFixed(2);
        const b = (Math.random() * 10).toFixed(2);
        const op = ["+", "-", "×", "÷"][getRandomInt(0, 3)];
        decProblems.push(`${a} ${op} ${b} = `);
      }

      return { intProblems, fracProblems, decProblems };
    }

    async function generatePDF() {
      const { jsPDF } = window.jspdf;
      const doc = new jsPDF();
      let y = 20;

      doc.setFontSize(18);
      doc.text("Math with Ms. Jean", 105, y, { align: "center" });
      y += 15;

      doc.setFontSize(14);
      doc.text("Integers", 20, y);
      y += 10;
      const { intProblems, fracProblems, decProblems } = generateProblems();
      intProblems.forEach(p => {
        doc.text(p, 20, y);
        y += 10;
      });

      y += 10;
      doc.text("Fractions", 20, y);
      y += 10;
      fracProblems.forEach(p => {
        doc.text(p.question, 20, y);
        y += 10;
      });

      y += 10;
      doc.text("Decimals", 20, y);
      y += 10;
      decProblems.forEach(p => {
        doc.text(p, 20, y);
        y += 10;
      });

      // Answer sheet
      doc.addPage();
      y = 20;
      doc.setFontSize(18);
      doc.text("Answer Key", 105, y, { align: "center" });
      y += 15;

      doc.setFontSize(14);
      doc.text("Fractions", 20, y);
      y += 10;
      fracProblems.forEach(p => {
        doc.text(`${p.question} ${p.answer}`, 20, y);
        y += 10;
      });

      doc.save("worksheet.pdf");
    }
  </script>
</body>
</html>
